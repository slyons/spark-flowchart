<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<title>Failure executor large record - Spark Advanced Topics</title>
<link href="../../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<script defer="" src="../../js/jquery-1.10.2.min.js"></script>
<script defer="" src="../../js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
<div class="container">
<a class="navbar-brand" href="../..">Spark Advanced Topics</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href="../..">Spark Advanced Topics Working Group Documentation</a>
</li>
<li class="dropdown active">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Details <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../analysis-exception/">org.apache.spark.sql.AnalysisException</a>
</li>
<li>
<a class="dropdown-item" href="../bad_partitioning/">Bad Partitioning</a>
</li>
<li>
<a class="dropdown-item" href="../big-broadcast-join/">Too big broadcast joins</a>
</li>
<li>
<a class="dropdown-item" href="../broadcast-with-disable/">Tables getting broadcasted even when broadcast is disabled</a>
</li>
<li>
<a class="dropdown-item" href="../class-or-method-not-found/">Class or method not found</a>
</li>
<li>
<a class="dropdown-item" href="../collect/">Bringing too much data back to the driver (collect and friends)</a>
</li>
<li>
<a class="dropdown-item" href="../container-oom/">Container OOMs</a>
</li>
<li>
<a class="dropdown-item" href="../correlated-column-not-allowed/">org.apache.spark.sql.AnalysisException: Correlated column is not allowed in predicate</a>
</li>
<li>
<a class="dropdown-item" href="../driver-max-result-size/">Result size larger than spark.driver.maxResultsSize error</a>
</li>
<li>
<a class="dropdown-item" href="../even_partioning_still_slow/">Even Partitioning Yet Still Slow</a>
</li>
<li>
<a class="dropdown-item" href="../executor-out-of-disk/">Executor out of disk error</a>
</li>
<li>
<a class="dropdown-item" href="../failed-to-read-non-parquet-file/">Failed to read non-parquet file</a>
</li>
<li>
<a class="dropdown-item active" href="./">Failure executor large record</a>
</li>
<li>
<a class="dropdown-item" href="../failure-executor-out-of-memory/">Failure executor out of memory</a>
</li>
<li>
<a class="dropdown-item" href="../filter_pushdown/">Filter / Predicate Pushdown</a>
</li>
<li>
<a class="dropdown-item" href="../forced-computations/">Force computations</a>
</li>
<li>
<a class="dropdown-item" href="../invalid-file/">Missing Files / File Not Found / Reading past RLE/BitPacking stream</a>
</li>
<li>
<a class="dropdown-item" href="../key-skew/">Key/Partition Skew</a>
</li>
<li>
<a class="dropdown-item" href="../partial_aggregates/">Partial v.s. Full Aggregates</a>
</li>
<li>
<a class="dropdown-item" href="../pyudfoom/">PySpark UDF / UDAF OOM</a>
</li>
<li>
<a class="dropdown-item" href="../regex-tips/">Regular Expression Tips</a>
</li>
<li>
<a class="dropdown-item" href="../slow-executor/">Slow executor</a>
</li>
<li>
<a class="dropdown-item" href="../toobigdag/">Too Big DAG (or when iterative algorithms go bump in the night)</a>
</li>
<li>
<a class="dropdown-item" href="../udfslow/">Avoid UDFs for the most part</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Flowchart <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../../flowchart/">Index</a>
</li>
<li>
<a class="dropdown-item" href="../../flowchart/error/">Error</a>
</li>
<li>
<a class="dropdown-item" href="../../flowchart/shared/">Shared</a>
</li>
<li>
<a class="dropdown-item" href="../../flowchart/slow/">Slow</a>
</li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" data-target="#mkdocs_search_modal" data-toggle="modal" href="#">
<i class="fa fa-search"></i> Search
                            </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../failed-to-read-non-parquet-file/" rel="prev">
<i class="fa fa-arrow-left"></i> Previous
                                </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../failure-executor-out-of-memory/" rel="next">
                                    Next <i class="fa fa-arrow-right"></i>
</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<p>Large record failures can show up in a few different ways.</p>
<p>For particularly large records you may find an executor out of memory exception</p>
<p>You can get a Kyro serialization (for SQL) or Java serialization error (for RDD).</p>
<p>Some common causes of too big records are <code>groupByKey</code> in RDD land, <code>UDAFs</code> or list aggregations in Spark SQL, highly compressed or Sparse records without a sparse seriaization.</p>
<p>If you are uncertain of where exactely the too big record is coming from after looking at the executor logs, you can try and seperate the stage which is failing into distinct parts of the code by using <code>persist</code> at the <code>DISK_ONLY</code> level to introduce cuts into the graph.</p>
<p>If your exception is happening with a Python UDF, it's possible that the individual records themselves might not be too large, but the batch-size used by Spark is set too high for the size of your records. You can try turning down the record size.</p></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Copyright various authors 2021, CC-BY-SA 4.0</p>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script defer="" src="../../js/base.js"></script>
<script defer="" src="../../search/main.js"></script>
<div aria-hidden="true" aria-labelledby="searchModalLabel" class="modal" id="mkdocs_search_modal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="searchModalLabel">Search</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<p>From here you can search these documents. Enter your search terms below.</p>
<form>
<div class="form-group">
<input class="form-control" id="mkdocs-search-query" placeholder="Search..." title="Type search term here" type="search"/>
</div>
</form>
<div data-no-results-text="No results found" id="mkdocs-search-results"></div>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div><div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
</body>
</html>
